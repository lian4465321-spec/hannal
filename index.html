<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>한날</title>

<style>
html,body{margin:0;height:100%}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Apple SD Gothic Neo",sans-serif;
  background:#f7f5f2;
  color:rgba(0,0,0,.88);
  line-height:1.85;
  overflow-y:auto;
  overscroll-behavior-y:none;
  scroll-behavior:smooth;
}

/* ===== 프레임 ===== */
body::before{
  content:"";
  position:fixed;
  top:calc(8px + env(safe-area-inset-top));
  bottom:calc(8px + env(safe-area-inset-bottom));
  left:calc(12px + env(safe-area-inset-left));
  right:calc(12px + env(safe-area-inset-right));
  border:1px solid rgba(34,34,34,.12);
  border-radius:12px;
  pointer-events:none;
  z-index:50;
}

/* ===== 페이지 ===== */
.page{
  height:100svh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.container{
  width:100%;
  max-width:420px;
  padding:20px;
  box-sizing:border-box;
}

/* ===== Intro ===== */
.intro{text-align:center}
.brand{font-size:30px;letter-spacing:1px}
.tagline{font-size:14px;color:rgba(0,0,0,.56);margin-top:10px}
.scroll-hint{margin-top:40px;font-size:12px;color:rgba(0,0,0,.42)}

/* ===== 상단 버튼 ===== */
.topRight{
  position:fixed;
  top:14px;
  right:14px;
  z-index:60;
}
.chip{
  border:0;
  padding:10px 14px;
  border-radius:999px;
  font-size:12px;
  background:rgba(0,0,0,.05);
}

/* ===== Register ===== */
#pageRegister .container{
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
}
.register-title{text-align:center;font-size:15px;color:rgba(0,0,0,.56);margin-bottom:18px}
.birth-row{display:flex;justify-content:space-between;gap:8px}
.birth-item{display:flex;align-items:center;gap:4px}
.birth-item input{
  width:56px;
  padding:10px;
  text-align:center;
  border-radius:10px;
  border:1px solid rgba(0,0,0,.12);
  font-size:16px;
}
.actions{margin-top:14px;display:grid;gap:10px}
button.primary,button.secondary{
  padding:12px;
  border-radius:12px;
  border:0;
  font-size:15px;
}
button.primary{background:rgba(0,0,0,.07)}
button.secondary{background:rgba(0,0,0,.04)}
.small{text-align:center;font-size:12px;color:rgba(0,0,0,.42);margin-top:10px}

/* ===== Fortune ===== */
.fortune{text-align:center}
.date{font-size:14px;color:rgba(0,0,0,.56)}
.score{margin-top:10px;font-size:18px}
.score-desc{font-size:14px;color:rgba(0,0,0,.56);margin-top:6px}
.fortune-text{margin-top:90px;font-size:17px}
.direction{margin-top:90px}
.direction-head{color:rgba(0,0,0,.56);margin-bottom:10px}
.mini-link{margin-top:60px;font-size:12px;color:rgba(0,0,0,.42)}
.mini-link button{border:0;background:none;text-decoration:underline}

/* ===== 공통 ===== */
.hidden{display:none!important}
</style>
</head>

<body>

<div class="topRight">
  <button class="chip" id="themeBtn">다크모드</button>
</div>

<section class="page" id="pageIntro">
  <div class="container intro">
    <div class="brand">한날</div>
    <div class="tagline">nothing more is needed</div>
    <div class="scroll-hint">아래로 스크롤</div>
  </div>
</section>

<section class="page" id="pageRegister">
  <div class="container">
    <div class="register-title" id="registerTitle">생년월일시를 한 번만 적어두면 됩니다.</div>
    <form id="registerForm">
      <div class="birth-row">
        <div class="birth-item"><input id="year" placeholder="1999"><span>년</span></div>
        <div class="birth-item"><input id="month" placeholder="07"><span>월</span></div>
        <div class="birth-item"><input id="day" placeholder="21"><span>일</span></div>
        <div class="birth-item"><input id="hour" placeholder="15"><span>시</span></div>
      </div>
      <div class="actions">
        <button class="primary">저장하고 오늘 보기</button>
        <button type="button" class="secondary hidden" id="cancelBtn">그대로 둘게요</button>
      </div>
      <div class="small">저장은 이 기기 안에만 됩니다.</div>
    </form>
  </div>
</section>

<section class="page hidden" id="pageFortune">
  <div class="container fortune">
    <div class="date" id="todayDate"></div>
    <div class="score">오늘의 흐름 점수 <strong id="score"></strong>점</div>
    <div class="score-desc" id="scoreDesc"></div>
    <div class="fortune-text">
      <p id="line1"></p>
      <p id="line2"></p>
    </div>
    <div class="direction">
      <div class="direction-head">오늘은</div>
      <div id="direction"></div>
    </div>
    <div class="mini-link">
      <button id="editBtn">정보 바꾸기</button>
    </div>
  </div>
</section>

<section class="page hidden" id="pageEnd">
  <div class="container" style="text-align:center;font-size:13px;color:rgba(0,0,0,.42)">HANNAL</div>
</section>

<script>
/* ===== 페이지 전환 ===== */
const pages=[pageIntro,pageRegister,pageFortune,pageEnd];
let isAnimating=false,lastMoveAt=0;

function activePages(){
  return pages.filter(p=>!p.classList.contains("hidden") && p.style.display!=="none");
}
function currentIndex(){
  const aps=activePages();
  let best=0,dist=1e9;
  aps.forEach((p,i)=>{
    const d=Math.abs(p.offsetTop-window.scrollY);
    if(d<dist){dist=d;best=i}
  });
  return best;
}
function goTo(i){
  const aps=activePages();
  if(!aps[i])return;
  isAnimating=true;
  aps[i].scrollIntoView({behavior:"smooth"});
  setTimeout(()=>isAnimating=false,1200);
}
function intent(dir){
  const now=Date.now();
  if(isAnimating||now-lastMoveAt<1400)return;
  lastMoveAt=now;
  goTo(currentIndex()+dir);
}
window.addEventListener("wheel",e=>{
  e.preventDefault();
  intent(e.deltaY>0?1:-1);
},{passive:false});
let sy=null;
window.addEventListener("touchstart",e=>sy=e.touches[0].clientY,{passive:true});
window.addEventListener("touchend",e=>{
  const dy=e.changedTouches[0].clientY-sy;
  if(Math.abs(dy)>35)intent(dy<0?1:-1);
},{passive:true});

/* ===== 운세 ===== */
function today(){
  const d=new Date();
  todayDate.innerText=`${d.getFullYear()}년 ${d.getMonth()+1}월 ${d.getDate()}일`;
  score.innerText=60+Math.floor(Math.random()*20);
  scoreDesc.innerText="크게 흔들리지 않는 흐름인 것 같습니다.";
  line1.innerText="오늘은 조용한 리듬이 어울리는 날인 것 같습니다.";
  line2.innerText="서두르지 않아도 흐름이 이어질 것 같습니다.";
  direction.innerText="유지하는 선택이 편할 것 같습니다.";
}

/* ===== 저장 / 편집 ===== */
registerForm.addEventListener("submit",e=>{
  e.preventDefault();
  pageRegister.classList.add("hidden");
  pageRegister.style.display="none";
  pageFortune.classList.remove("hidden");
  pageEnd.classList.remove("hidden");
  today();
  lastMoveAt=0;
});
editBtn.addEventListener("click",()=>{
  pageRegister.style.display="flex";
  pageRegister.classList.remove("hidden");
  cancelBtn.classList.remove("hidden");
  pageRegister.scrollIntoView({behavior:"smooth"});
});
cancelBtn.addEventListener("click",()=>{
  pageRegister.classList.add("hidden");
  pageRegister.style.display="none";
  cancelBtn.classList.add("hidden");
  pageFortune.scrollIntoView({behavior:"smooth"});
});
</script>

</body>
</html>
